SELECT projects.id, projects.name, users.login FROM projects INNER JOIN users ON projects.owner_id=users.id WHERE (
--not a fork
(projects.forked_from IS NULL) AND
--not deleted
(projects.deleted=0) AND
--at least 10 contributors
((SELECT COUNT(distinct(author_id)) FROM commits WHERE project_id = projects.id) >= 10) AND 
--have at least 10 changes (commits or pull requests) during the previous month,	
(((SELECT COUNT(id) FROM commits WHERE project_id = projects.id AND TIMESTAMPDIFF(month, DATE_FORMAT(commits.created_at,'%Y-%m-%d'), DATE_FORMAT(NOW(),'%Y-%m-%d')) <= 1) + 
 (SELECT COUNT(base_repo_id) FROM pull_requests, pull_request_history WHERE pull_requests.id=pull_request_history.pull_request_id AND TIMESTAMPDIFF(month, DATE_FORMAT(pull_request_history.created_at,'%Y-%m-%d'), DATE_FORMAT(NOW(),'%Y-%m-%d')) <= 1)) >= 10) AND
--at least one year old
(TIMESTAMPDIFF(year, DATE_FORMAT(projects.created_at,'%Y-%m-%d'), DATE_FORMAT(NOW(),'%Y-%m-%d')) >= 1) AND 
--at least one commit
(SELECT COUNT(id) FROM commits WHERE project_id=projects.id >= 1) AND 
--at least one pull requests
(SELECT COUNT(base_repo_id) FROM pull_requests WHERE base_repo_id=projects.id >= 1) AND
--in ruby, java or python
(projects.language = 'Ruby' OR projects.language = 'Java' OR projects.language = 'Python')
)
